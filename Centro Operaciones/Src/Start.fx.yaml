Start As screen:
    Height: =1136
    Width: |
        =640

    Image3 As image:
        Height: =Parent.Height
        Image: =control_center_in_a_farm_machine
        ImagePosition: =ImagePosition.Fill
        Width: =Parent.Width
        ZIndex: =1

    Rectangle2 As rectangle:
        Fill: =RGBA(0, 0, 0, 0.5)
        Height: =Parent.Height
        Width: =Parent.Width
        ZIndex: =2

    Image6 As image:
        Image: =BayerLogo
        X: =22
        Y: =1020
        ZIndex: =3

    Label1_2 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Lato
        FontWeight: =FontWeight.Bold
        Height: =141
        Size: =35
        Text: ="Centro de Operaciones"
        Width: =300
        X: =170
        Y: =47
        ZIndex: =4

    Label1_3 As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        Fill: =If(Connection.Connected, RGBA(209, 232, 178, 1),RGBA(255, 194, 194, 1))
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Height: =30
        PaddingLeft: =10
        Text: |-
            =If(
                Connection.Connected && !IsBlank(UserData),
                "Estás conectado! Cargue los datos para iniciar la aplicación.",
                If(
                    !Connection.Connected && IsBlank(UserData),
                    "No estás conectado, busca un lugar con conexión para cargar los datos!",
                    ""
                )
            )
        Visible: =!varDadosCarregados
        Width: =Parent.Width
        ZIndex: =5

    Button3 As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderThickness: =1
        Color: =RGBA(0, 0, 0, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        Fill: =RGBA(137, 211, 41, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FocusedBorderThickness: =2
        Font: =Font.'Segoe UI'
        Height: =76
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =ColorFade(Self.Fill, -25%) 
        OnSelect: |-
            =Set(varDadosCarregados,true);
            Notify(
                "Los datos se cargaron correctamente!",
                NotificationType.Success,
                3000
            );
            Set(varDataCarregamento,Now());
            
            
            /*CARREGAR DADOS USUÁRIO*/
            If(
                Connection.Connected,
            
                /*Coleção dados Usuário*/
                ClearCollect(UserImage, UsuáriosdoOffice365.UserPhotoV2(UsuáriosdoOffice365.MyProfileV2().id));
                ClearCollect(UserData, { MyProfile: UsuáriosdoOffice365.MyProfileV2() }, { DataTime: Now() } );
            
                /*Salvar Local*/
                SaveData(UserImage,"UserDataImage");
                SaveData(UserData,"UserDataLocal"), 
            
                /*Carregar dados Locais*/
                LoadData(UserImage,"UserDataImage");
                LoadData(UserData,"UserDataLocal")
            )
        PressedBorderColor: =ColorFade(RGBA(137, 211, 41, 1), -50%)
        PressedColor: =Black
        PressedFill: =ColorFade(Self.Fill, -15%)
        RadiusBottomLeft: =60
        RadiusBottomRight: =60
        RadiusTopLeft: =60
        RadiusTopRight: =60
        Size: =If(varDadosCarregados, 15,20)
        Text: |-
            =If(
                !Connection.Connected && IsBlank(UserData),
                "Sin conexión",
                If(
                    Connection.Connected && !IsBlank(UserData),
                    "Cargar datos más recientes",
                    If(
                        varDadosCarregados,
                        "Recargar datos",
                        "Cargar datos"
                    )
                )
            )
        Tooltip: |-
            =If(
                !Connection.Connected,
                "Sin conexión",
                If(
                    varDadosCarregados,
                    "Recargar datos",
                    "Cargar datos"
                )
            )
        Width: =333
        X: =153
        Y: =595
        ZIndex: =6

    Label2_1 As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Height: =72
        Size: =11.5
        Text: |-
            ="Datos cargados en " & Text(First(UserData.DataTime).DataTime, "dd/mm/yyy hh:mm") & " Las operaciones ahora funcionarán sin conexión."
        Visible: =varDadosCarregados
        Width: =300
        X: =170
        Y: =995
        ZIndex: =7

    Button3_1 As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderThickness: =1
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        Fill: =RGBA(0, 188, 255, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FocusedBorderThickness: =2
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =69
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =Self.Color
        HoverFill: =ColorFade(Self.Fill, -25%) 
        OnSelect: =Navigate(Home)
        PressedBorderColor: =ColorFade(RGBA(0, 188, 255, 1), -50%)
        PressedColor: |
            =Self.Color
        PressedFill: =ColorFade(Self.Fill, -15%)
        RadiusBottomLeft: =70
        RadiusBottomRight: =70
        RadiusTopLeft: =70
        RadiusTopRight: =70
        Size: =20
        Text: ="Empezar"
        Tooltip: ="Empezar"
        Visible: =If( !IsBlank(UserData), true, false)
        Width: =440
        X: =100
        Y: =359
        ZIndex: =8

    Icon4 As icon.Leave:
        AccessibleLabel: ="Sair"
        Color: =RGBA(255, 255, 255, 1)
        Height: =40
        Icon: =Icon.Leave
        OnSelect: =Exit()
        Tooltip: ="Salir"
        Width: =40
        X: =22
        Y: =47
        ZIndex: =9

